{"ast":null,"code":"import _objectSpread from\"D:/Edu Project/mern-auth-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/* eslint-disable no-unused-vars *//* eslint-disable jsx-a11y/anchor-is-valid */import React,{useState,useEffect}from'react';import{AlertCircle,CreditCard,Shield,Truck,Clock}from'lucide-react';import{loadStripe}from'@stripe/stripe-js';import axios from'axios';import{useNavigate}from'react-router-dom';// Initialize Stripe (replace with your publishable key)\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const stripePromise=loadStripe(process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY);const Checkout=()=>{const navigate=useNavigate();const[formData,setFormData]=useState({email:'',firstName:'',lastName:'',phone:'',address:'',city:'',state:'',pincode:'',paymentMethod:'card'});const[cartItems,setCartItems]=useState([]);const[loading,setLoading]=useState(false);const[pageLoading,setPageLoading]=useState(true);const[errors,setErrors]=useState({});const[isDirectPurchase,setIsDirectPurchase]=useState(false);// Track if it's a direct purchase\n// Get user info\nconst token=localStorage.getItem('token');const user=JSON.parse(localStorage.getItem('user')||'{}');// Indian states for dropdown\nconst indianStates=['Andhra Pradesh','Arunachal Pradesh','Assam','Bihar','Chhattisgarh','Goa','Gujarat','Haryana','Himachal Pradesh','Jharkhand','Karnataka','Kerala','Madhya Pradesh','Maharashtra','Manipur','Meghalaya','Mizoram','Nagaland','Odisha','Punjab','Rajasthan','Sikkim','Tamil Nadu','Telangana','Tripura','Uttar Pradesh','Uttarakhand','West Bengal','Delhi','Jammu and Kashmir','Ladakh','Puducherry'];// Fetch cart items on component mount\nuseEffect(()=>{const fetchCartData=async()=>{try{const token=localStorage.getItem(\"token\");if(!token){navigate(\"/login\");return;}// FIRST: Check if there's direct \"Buy Now\" data in sessionStorage\nconst sessionCartData=sessionStorage.getItem(\"cartData\");if(sessionCartData){console.log(\"Using Buy Now data from sessionStorage\");const parsedData=JSON.parse(sessionCartData);setIsDirectPurchase(true);// Mark as direct purchase\n// Format the data to match your component's expected structure\nconst formattedItems=parsedData.courses.map(course=>({_id:course._id,courseId:course._id,title:course.title,instructor:course.instructor||\"N/A\",price:course.price||0,image:course.image||\"https://images.unsplash.com/photo-1633356122544-f134324a6cee?w=150&h=100&fit=crop\",duration:course.duration||\"N/A\",quantity:1}));setCartItems(formattedItems);// Pre-fill email if user is logged in\nif(user.email){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{email:user.email}));}setPageLoading(false);return;// Exit early, don't fetch from API\n}// SECOND: If no sessionStorage data, fetch from API (regular cart flow)\nconsole.log(\"Fetching cart data from API...\");setIsDirectPurchase(false);// Mark as regular cart purchase\nconst response=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/cart\"),{headers:{Authorization:\"Bearer \".concat(token)}});console.log(\"Cart data received for checkout:\",response.data);// Process cart items - handle both response formats\nif(response.data&&response.data.items){const processedItems=response.data.items.map(item=>({_id:item.course._id,courseId:item.course._id,title:item.course.title,instructor:item.course.instructor||\"N/A\",price:item.course.discountedPrice||item.course.price||0,image:item.course.thumbnailUrl?\"\".concat(process.env.REACT_APP_API_URL||'http://localhost:5000').concat(item.course.thumbnailUrl):\"https://images.unsplash.com/photo-1633356122544-f134324a6cee?w=150&h=100&fit=crop\",duration:item.course.duration||\"N/A\",quantity:item.quantity||1}));setCartItems(processedItems);}else if(response.data&&Array.isArray(response.data)){const processedItems=response.data.map(item=>({_id:item.course._id,courseId:item.course._id,title:item.course.title,instructor:item.course.instructor||\"N/A\",price:item.course.discountedPrice||item.course.price||0,image:item.course.thumbnailUrl?\"\".concat(process.env.REACT_APP_API_URL||'http://localhost:5000').concat(item.course.thumbnailUrl):\"https://images.unsplash.com/photo-1633356122544-f134324a6cee?w=150&h=100&fit=crop\",duration:item.course.duration||\"N/A\",quantity:item.quantity||1}));setCartItems(processedItems);}// Pre-fill email if user is logged in\nif(user.email){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{email:user.email}));}}catch(error){var _error$response;console.error(\"Error fetching cart data for checkout:\",error);if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401){console.log(\"Unauthorized - redirecting to login\");localStorage.removeItem(\"token\");navigate(\"/login\");}else{var _error$response2,_error$response2$data;console.error(\"Checkout cart fetch error:\",((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||error.message);alert(\"Failed to load cart data. Please try again.\");}}finally{setPageLoading(false);}};fetchCartData();},[navigate,user.email]);// Calculate totals\nconst subtotal=cartItems.reduce((sum,item)=>{const price=item.price||0;const quantity=item.quantity||1;return sum+price*quantity;},0);const shipping=subtotal>50000?0:500;// Free shipping above â‚¹50,000\nconst tax=Math.round(subtotal*0.18);// 18% GST\nconst total=subtotal+shipping+tax;// Format currency in Indian format\nconst formatCurrency=amount=>{return new Intl.NumberFormat('en-IN',{style:'currency',currency:'INR',minimumFractionDigits:0}).format(amount);};const handleInputChange=e=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));// Clear error when user starts typing\nif(errors[name]){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:''}));}};const validateForm=()=>{const newErrors={};if(!formData.email)newErrors.email='Email is required';else if(!/\\S+@\\S+\\.\\S+/.test(formData.email))newErrors.email='Email is invalid';if(!formData.firstName)newErrors.firstName='First name is required';if(!formData.lastName)newErrors.lastName='Last name is required';if(!formData.phone)newErrors.phone='Phone number is required';else if(!/^[6-9]\\d{9}$/.test(formData.phone))newErrors.phone='Enter valid 10-digit Indian mobile number';if(!formData.address)newErrors.address='Address is required';if(!formData.city)newErrors.city='City is required';if(!formData.state)newErrors.state='State is required';if(!formData.pincode)newErrors.pincode='PIN code is required';else if(!/^\\d{6}$/.test(formData.pincode))newErrors.pincode='Enter valid 6-digit PIN code';setErrors(newErrors);return Object.keys(newErrors).length===0;};// Stripe Checkout Session Handler\nconst handleStripeCheckout=async()=>{if(!validateForm())return;if(cartItems.length===0){alert('Your cart is empty!');return;}setLoading(true);try{var _orderData$order;console.log(\"=== STRIPE CHECKOUT PROCESS ===\");// Step 1: Create order first\nconst orderPayload=_objectSpread({customerInfo:{firstName:formData.firstName,lastName:formData.lastName,email:formData.email,phone:formData.phone,address:formData.address,city:formData.city,state:formData.state,pincode:formData.pincode},paymentMethod:'card'},isDirectPurchase&&{items:cartItems.map(item=>({courseId:item.courseId,quantity:item.quantity||1,price:item.price}))});console.log(\"Creating order...\",orderPayload);const orderResponse=await fetch(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/create\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'},body:JSON.stringify(orderPayload)});if(!orderResponse.ok){const errorData=await orderResponse.json().catch(()=>({message:'Failed to create order'}));throw new Error(errorData.message||'Failed to create order');}const orderData=await orderResponse.json();console.log(\"Order created successfully:\",orderData);if(!(orderData!==null&&orderData!==void 0&&(_orderData$order=orderData.order)!==null&&_orderData$order!==void 0&&_orderData$order._id)){throw new Error('Invalid order response - missing order ID');}// Step 2: Create Stripe Checkout Session\nconsole.log(\"Creating Stripe checkout session...\");const checkoutPayload={orderId:orderData.order._id};const checkoutResponse=await fetch(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/create-checkout-session\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'},body:JSON.stringify(checkoutPayload)});if(!checkoutResponse.ok){const errorData=await checkoutResponse.json().catch(()=>({message:'Failed to create checkout session'}));throw new Error(errorData.message||'Failed to create checkout session');}const checkoutData=await checkoutResponse.json();console.log(\"Checkout session created:\",checkoutData);if(!checkoutData.success||!checkoutData.url){throw new Error('Invalid checkout session response');}// Step 3: Clear sessionStorage after successful order creation\nif(isDirectPurchase){sessionStorage.removeItem(\"cartData\");}// Step 4: Redirect to Stripe Checkout\nconsole.log(\"Redirecting to Stripe Checkout...\");window.location.href=checkoutData.url;}catch(error){console.error('Stripe checkout error:',error);alert(\"Checkout failed: \".concat(error.message));}finally{setLoading(false);}};// Handle non-Stripe payments (UPI, NetBanking)\nconst handleNonStripePayment=async()=>{console.log(\"Processing non-Stripe payment:\",formData.paymentMethod);alert(\"\".concat(formData.paymentMethod,\" payment is not yet implemented. Please use card payment.\"));};// Main submit handler\nconst handleSubmit=async e=>{e.preventDefault();if(formData.paymentMethod==='card'){// Use Stripe Checkout for card payments\nawait handleStripeCheckout();}else{// Handle other payment methods\nawait handleNonStripePayment();}};// Show loading state\nif(pageLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-light min-vh-100 d-flex align-items-center justify-content-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-primary mb-3\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading...\"})}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading checkout...\"})]})});}return/*#__PURE__*/_jsx(\"div\",{className:\"bg-light min-vh-100 py-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header bg-white\",children:/*#__PURE__*/_jsxs(\"h4\",{className:\"mb-0\",children:[/*#__PURE__*/_jsx(CreditCard,{className:\"me-2\",size:24}),\"Checkout\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-3\",children:\"Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"row g-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"First Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control \".concat(errors.firstName?'is-invalid':''),name:\"firstName\",value:formData.firstName,onChange:handleInputChange,placeholder:\"Enter your first name\"}),errors.firstName&&/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:errors.firstName})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Last Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control \".concat(errors.lastName?'is-invalid':''),name:\"lastName\",value:formData.lastName,onChange:handleInputChange,placeholder:\"Enter your last name\"}),errors.lastName&&/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:errors.lastName})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Email *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control \".concat(errors.email?'is-invalid':''),name:\"email\",value:formData.email,onChange:handleInputChange,placeholder:\"Enter your email\"}),errors.email&&/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Phone Number *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",className:\"form-control \".concat(errors.phone?'is-invalid':''),name:\"phone\",value:formData.phone,onChange:handleInputChange,placeholder:\"Enter 10-digit mobile number\"}),errors.phone&&/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:errors.phone})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Truck,{className:\"me-2\",size:20}),\"Shipping Address\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row g-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-12\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Address *\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control \".concat(errors.address?'is-invalid':''),name:\"address\",value:formData.address,onChange:handleInputChange,rows:\"3\",placeholder:\"Enter your complete address\"}),errors.address&&/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:errors.address})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"City *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control \".concat(errors.city?'is-invalid':''),name:\"city\",value:formData.city,onChange:handleInputChange,placeholder:\"Enter your city\"}),errors.city&&/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:errors.city})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"State *\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-control \".concat(errors.state?'is-invalid':''),name:\"state\",value:formData.state,onChange:handleInputChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select State\"}),indianStates.map(state=>/*#__PURE__*/_jsx(\"option\",{value:state,children:state},state))]}),errors.state&&/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:errors.state})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"PIN Code *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control \".concat(errors.pincode?'is-invalid':''),name:\"pincode\",value:formData.pincode,onChange:handleInputChange,placeholder:\"Enter 6-digit PIN code\"}),errors.pincode&&/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:errors.pincode})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Shield,{className:\"me-2\",size:20}),\"Payment Method\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row g-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-check\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"radio\",name:\"paymentMethod\",value:\"card\",checked:formData.paymentMethod==='card',onChange:handleInputChange}),/*#__PURE__*/_jsxs(\"label\",{className:\"form-check-label\",children:[/*#__PURE__*/_jsx(CreditCard,{size:16,className:\"me-2\"}),\"Credit/Debit Card\"]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-check\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"radio\",name:\"paymentMethod\",value:\"upi\",checked:formData.paymentMethod==='upi',onChange:handleInputChange}),/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",children:\"UPI\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-check\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"radio\",name:\"paymentMethod\",value:\"netbanking\",checked:formData.paymentMethod==='netbanking',onChange:handleInputChange}),/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",children:\"Net Banking\"})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-3\",children:\"Order Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded p-3\",children:[cartItems.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.title,className:\"rounded me-3\",style:{width:'50px',height:'40px',objectFit:'cover'}}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"mb-0\",children:item.title}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[item.instructor,\" \\u2022 \",item.duration,item.quantity>1&&\" \\u2022 Qty: \".concat(item.quantity)]})]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"fw-bold\",children:formatCurrency(item.price*item.quantity)})]},index)),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Subtotal:\"}),/*#__PURE__*/_jsx(\"span\",{children:formatCurrency(subtotal)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Shipping:\"}),/*#__PURE__*/_jsx(\"span\",{children:shipping===0?'Free':formatCurrency(shipping)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Tax (GST 18%):\"}),/*#__PURE__*/_jsx(\"span\",{children:formatCurrency(tax)})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between fw-bold fs-5\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total:\"}),/*#__PURE__*/_jsx(\"span\",{children:formatCurrency(total)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-info d-flex align-items-center mb-4\",children:[/*#__PURE__*/_jsx(Shield,{className:\"me-2\",size:20}),/*#__PURE__*/_jsx(\"small\",{children:\"Your payment information is secure and encrypted. We use industry-standard security measures to protect your data.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary btn-lg px-5\",disabled:loading||cartItems.length===0,children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border spinner-border-sm me-2\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading...\"})}),\"Processing...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CreditCard,{className:\"me-2\",size:20}),\"Complete Payment (\",formatCurrency(total),\")\"]})})})]})})]})})})})});};export default Checkout;","map":{"version":3,"names":["React","useState","useEffect","AlertCircle","CreditCard","Shield","Truck","Clock","loadStripe","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","stripePromise","process","env","REACT_APP_STRIPE_PUBLISHABLE_KEY","Checkout","navigate","formData","setFormData","email","firstName","lastName","phone","address","city","state","pincode","paymentMethod","cartItems","setCartItems","loading","setLoading","pageLoading","setPageLoading","errors","setErrors","isDirectPurchase","setIsDirectPurchase","token","localStorage","getItem","user","JSON","parse","indianStates","fetchCartData","sessionCartData","sessionStorage","console","log","parsedData","formattedItems","courses","map","course","_id","courseId","title","instructor","price","image","duration","quantity","prev","_objectSpread","response","get","concat","REACT_APP_API_URL","headers","Authorization","data","items","processedItems","item","discountedPrice","thumbnailUrl","Array","isArray","error","_error$response","status","removeItem","_error$response2","_error$response2$data","message","alert","subtotal","reduce","sum","shipping","tax","Math","round","total","formatCurrency","amount","Intl","NumberFormat","style","currency","minimumFractionDigits","format","handleInputChange","e","name","value","target","validateForm","newErrors","test","Object","keys","length","handleStripeCheckout","_orderData$order","orderPayload","customerInfo","orderResponse","fetch","method","body","stringify","ok","errorData","json","catch","Error","orderData","order","checkoutPayload","orderId","checkoutResponse","checkoutData","success","url","window","location","href","handleNonStripePayment","handleSubmit","preventDefault","className","children","role","size","onSubmit","type","onChange","placeholder","rows","checked","index","src","alt","width","height","objectFit","disabled"],"sources":["D:/Edu Project/mern-auth-frontend/src/pages/User/Checkout.jsx"],"sourcesContent":["/* eslint-disable no-unused-vars */\r\n/* eslint-disable jsx-a11y/anchor-is-valid */\r\nimport React, { useState, useEffect } from 'react';\r\nimport { AlertCircle, CreditCard, Shield, Truck, Clock } from 'lucide-react';\r\nimport { loadStripe } from '@stripe/stripe-js';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\n// Initialize Stripe (replace with your publishable key)\r\nconst stripePromise = loadStripe(process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY);\r\n\r\nconst Checkout = () => {\r\n    const navigate = useNavigate();\r\n\r\n    const [formData, setFormData] = useState({\r\n        email: '',\r\n        firstName: '',\r\n        lastName: '',\r\n        phone: '',\r\n        address: '',\r\n        city: '',\r\n        state: '',\r\n        pincode: '',\r\n        paymentMethod: 'card'\r\n    });\r\n\r\n    const [cartItems, setCartItems] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [pageLoading, setPageLoading] = useState(true);\r\n    const [errors, setErrors] = useState({});\r\n    const [isDirectPurchase, setIsDirectPurchase] = useState(false); // Track if it's a direct purchase\r\n\r\n    // Get user info\r\n    const token = localStorage.getItem('token');\r\n    const user = JSON.parse(localStorage.getItem('user') || '{}');\r\n\r\n    // Indian states for dropdown\r\n    const indianStates = [\r\n        'Andhra Pradesh', 'Arunachal Pradesh', 'Assam', 'Bihar', 'Chhattisgarh',\r\n        'Goa', 'Gujarat', 'Haryana', 'Himachal Pradesh', 'Jharkhand', 'Karnataka',\r\n        'Kerala', 'Madhya Pradesh', 'Maharashtra', 'Manipur', 'Meghalaya', 'Mizoram',\r\n        'Nagaland', 'Odisha', 'Punjab', 'Rajasthan', 'Sikkim', 'Tamil Nadu',\r\n        'Telangana', 'Tripura', 'Uttar Pradesh', 'Uttarakhand', 'West Bengal',\r\n        'Delhi', 'Jammu and Kashmir', 'Ladakh', 'Puducherry'\r\n    ];\r\n\r\n    // Fetch cart items on component mount\r\n    useEffect(() => {\r\n        const fetchCartData = async () => {\r\n            try {\r\n                const token = localStorage.getItem(\"token\");\r\n\r\n                if (!token) {\r\n                    navigate(\"/login\");\r\n                    return;\r\n                }\r\n\r\n                // FIRST: Check if there's direct \"Buy Now\" data in sessionStorage\r\n                const sessionCartData = sessionStorage.getItem(\"cartData\");\r\n                if (sessionCartData) {\r\n                    console.log(\"Using Buy Now data from sessionStorage\");\r\n                    const parsedData = JSON.parse(sessionCartData);\r\n                    setIsDirectPurchase(true); // Mark as direct purchase\r\n\r\n                    // Format the data to match your component's expected structure\r\n                    const formattedItems = parsedData.courses.map(course => ({\r\n                        _id: course._id,\r\n                        courseId: course._id,\r\n                        title: course.title,\r\n                        instructor: course.instructor || \"N/A\",\r\n                        price: course.price || 0,\r\n                        image: course.image || \"https://images.unsplash.com/photo-1633356122544-f134324a6cee?w=150&h=100&fit=crop\",\r\n                        duration: course.duration || \"N/A\",\r\n                        quantity: 1,\r\n                    }));\r\n\r\n                    setCartItems(formattedItems);\r\n\r\n                    // Pre-fill email if user is logged in\r\n                    if (user.email) {\r\n                        setFormData(prev => ({ ...prev, email: user.email }));\r\n                    }\r\n\r\n                    setPageLoading(false);\r\n                    return; // Exit early, don't fetch from API\r\n                }\r\n\r\n                // SECOND: If no sessionStorage data, fetch from API (regular cart flow)\r\n                console.log(\"Fetching cart data from API...\");\r\n                setIsDirectPurchase(false); // Mark as regular cart purchase\r\n                \r\n                const response = await axios.get(\r\n                    `${process.env.REACT_APP_API_URL}/api/cart`,\r\n                    {\r\n                        headers: {\r\n                            Authorization: `Bearer ${token}`,\r\n                        }\r\n                    }\r\n                );\r\n\r\n                console.log(\"Cart data received for checkout:\", response.data);\r\n\r\n                // Process cart items - handle both response formats\r\n                if (response.data && response.data.items) {\r\n                    const processedItems = response.data.items.map(item => ({\r\n                        _id: item.course._id,\r\n                        courseId: item.course._id,\r\n                        title: item.course.title,\r\n                        instructor: item.course.instructor || \"N/A\",\r\n                        price: item.course.discountedPrice || item.course.price || 0,\r\n                        image: item.course.thumbnailUrl ?\r\n                            `${process.env.REACT_APP_API_URL || 'http://localhost:5000'}${item.course.thumbnailUrl}` :\r\n                            \"https://images.unsplash.com/photo-1633356122544-f134324a6cee?w=150&h=100&fit=crop\",\r\n                        duration: item.course.duration || \"N/A\",\r\n                        quantity: item.quantity || 1,\r\n                    }));\r\n\r\n                    setCartItems(processedItems);\r\n                } else if (response.data && Array.isArray(response.data)) {\r\n                    const processedItems = response.data.map(item => ({\r\n                        _id: item.course._id,\r\n                        courseId: item.course._id,\r\n                        title: item.course.title,\r\n                        instructor: item.course.instructor || \"N/A\",\r\n                        price: item.course.discountedPrice || item.course.price || 0,\r\n                        image: item.course.thumbnailUrl ?\r\n                            `${process.env.REACT_APP_API_URL || 'http://localhost:5000'}${item.course.thumbnailUrl}` :\r\n                            \"https://images.unsplash.com/photo-1633356122544-f134324a6cee?w=150&h=100&fit=crop\",\r\n                        duration: item.course.duration || \"N/A\",\r\n                        quantity: item.quantity || 1,\r\n                    }));\r\n\r\n                    setCartItems(processedItems);\r\n                }\r\n\r\n                // Pre-fill email if user is logged in\r\n                if (user.email) {\r\n                    setFormData(prev => ({ ...prev, email: user.email }));\r\n                }\r\n\r\n            } catch (error) {\r\n                console.error(\"Error fetching cart data for checkout:\", error);\r\n\r\n                if (error.response?.status === 401) {\r\n                    console.log(\"Unauthorized - redirecting to login\");\r\n                    localStorage.removeItem(\"token\");\r\n                    navigate(\"/login\");\r\n                } else {\r\n                    console.error(\"Checkout cart fetch error:\", error.response?.data?.message || error.message);\r\n                    alert(\"Failed to load cart data. Please try again.\");\r\n                }\r\n            } finally {\r\n                setPageLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchCartData();\r\n    }, [navigate, user.email]);\r\n\r\n    // Calculate totals\r\n    const subtotal = cartItems.reduce((sum, item) => {\r\n        const price = item.price || 0;\r\n        const quantity = item.quantity || 1;\r\n        return sum + (price * quantity);\r\n    }, 0);\r\n\r\n    const shipping = subtotal > 50000 ? 0 : 500; // Free shipping above â‚¹50,000\r\n    const tax = Math.round(subtotal * 0.18); // 18% GST\r\n    const total = subtotal + shipping + tax;\r\n\r\n    // Format currency in Indian format\r\n    const formatCurrency = (amount) => {\r\n        return new Intl.NumberFormat('en-IN', {\r\n            style: 'currency',\r\n            currency: 'INR',\r\n            minimumFractionDigits: 0\r\n        }).format(amount);\r\n    };\r\n\r\n    const handleInputChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setFormData(prev => ({ ...prev, [name]: value }));\r\n\r\n        // Clear error when user starts typing\r\n        if (errors[name]) {\r\n            setErrors(prev => ({ ...prev, [name]: '' }));\r\n        }\r\n    };\r\n\r\n    const validateForm = () => {\r\n        const newErrors = {};\r\n\r\n        if (!formData.email) newErrors.email = 'Email is required';\r\n        else if (!/\\S+@\\S+\\.\\S+/.test(formData.email)) newErrors.email = 'Email is invalid';\r\n\r\n        if (!formData.firstName) newErrors.firstName = 'First name is required';\r\n        if (!formData.lastName) newErrors.lastName = 'Last name is required';\r\n        if (!formData.phone) newErrors.phone = 'Phone number is required';\r\n        else if (!/^[6-9]\\d{9}$/.test(formData.phone)) newErrors.phone = 'Enter valid 10-digit Indian mobile number';\r\n\r\n        if (!formData.address) newErrors.address = 'Address is required';\r\n        if (!formData.city) newErrors.city = 'City is required';\r\n        if (!formData.state) newErrors.state = 'State is required';\r\n        if (!formData.pincode) newErrors.pincode = 'PIN code is required';\r\n        else if (!/^\\d{6}$/.test(formData.pincode)) newErrors.pincode = 'Enter valid 6-digit PIN code';\r\n\r\n        setErrors(newErrors);\r\n        return Object.keys(newErrors).length === 0;\r\n    };\r\n\r\n    // Stripe Checkout Session Handler\r\n    const handleStripeCheckout = async () => {\r\n        if (!validateForm()) return;\r\n\r\n        if (cartItems.length === 0) {\r\n            alert('Your cart is empty!');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n\r\n        try {\r\n            console.log(\"=== STRIPE CHECKOUT PROCESS ===\");\r\n\r\n            // Step 1: Create order first\r\n            const orderPayload = {\r\n                customerInfo: {\r\n                    firstName: formData.firstName,\r\n                    lastName: formData.lastName,\r\n                    email: formData.email,\r\n                    phone: formData.phone,\r\n                    address: formData.address,\r\n                    city: formData.city,\r\n                    state: formData.state,\r\n                    pincode: formData.pincode\r\n                },\r\n                paymentMethod: 'card',\r\n                // Include items for direct purchase\r\n                ...(isDirectPurchase && {\r\n                    items: cartItems.map(item => ({\r\n                        courseId: item.courseId,\r\n                        quantity: item.quantity || 1,\r\n                        price: item.price\r\n                    }))\r\n                })\r\n            };\r\n\r\n            console.log(\"Creating order...\", orderPayload);\r\n\r\n            const orderResponse = await fetch(`${process.env.REACT_APP_API_URL}/api/orders/create`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`,\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify(orderPayload)\r\n            });\r\n\r\n            if (!orderResponse.ok) {\r\n                const errorData = await orderResponse.json().catch(() => ({ message: 'Failed to create order' }));\r\n                throw new Error(errorData.message || 'Failed to create order');\r\n            }\r\n\r\n            const orderData = await orderResponse.json();\r\n            console.log(\"Order created successfully:\", orderData);\r\n\r\n            if (!orderData?.order?._id) {\r\n                throw new Error('Invalid order response - missing order ID');\r\n            }\r\n\r\n            // Step 2: Create Stripe Checkout Session\r\n            console.log(\"Creating Stripe checkout session...\");\r\n\r\n            const checkoutPayload = {\r\n                orderId: orderData.order._id\r\n            };\r\n\r\n            const checkoutResponse = await fetch(`${process.env.REACT_APP_API_URL}/api/orders/create-checkout-session`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`,\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify(checkoutPayload)\r\n            });\r\n\r\n            if (!checkoutResponse.ok) {\r\n                const errorData = await checkoutResponse.json().catch(() => ({ message: 'Failed to create checkout session' }));\r\n                throw new Error(errorData.message || 'Failed to create checkout session');\r\n            }\r\n\r\n            const checkoutData = await checkoutResponse.json();\r\n            console.log(\"Checkout session created:\", checkoutData);\r\n\r\n            if (!checkoutData.success || !checkoutData.url) {\r\n                throw new Error('Invalid checkout session response');\r\n            }\r\n\r\n            // Step 3: Clear sessionStorage after successful order creation\r\n            if (isDirectPurchase) {\r\n                sessionStorage.removeItem(\"cartData\");\r\n            }\r\n\r\n            // Step 4: Redirect to Stripe Checkout\r\n            console.log(\"Redirecting to Stripe Checkout...\");\r\n            window.location.href = checkoutData.url;\r\n\r\n        } catch (error) {\r\n            console.error('Stripe checkout error:', error);\r\n            alert(`Checkout failed: ${error.message}`);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // Handle non-Stripe payments (UPI, NetBanking)\r\n    const handleNonStripePayment = async () => {\r\n        console.log(\"Processing non-Stripe payment:\", formData.paymentMethod);\r\n        alert(`${formData.paymentMethod} payment is not yet implemented. Please use card payment.`);\r\n    };\r\n\r\n    // Main submit handler\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n\r\n        if (formData.paymentMethod === 'card') {\r\n            // Use Stripe Checkout for card payments\r\n            await handleStripeCheckout();\r\n        } else {\r\n            // Handle other payment methods\r\n            await handleNonStripePayment();\r\n        }\r\n    };\r\n\r\n    // Show loading state\r\n    if (pageLoading) {\r\n        return (\r\n            <div className=\"bg-light min-vh-100 d-flex align-items-center justify-content-center\">\r\n                <div className=\"text-center\">\r\n                    <div className=\"spinner-border text-primary mb-3\" role=\"status\">\r\n                        <span className=\"visually-hidden\">Loading...</span>\r\n                    </div>\r\n                    <p>Loading checkout...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"bg-light min-vh-100 py-4\">\r\n            <div className=\"container\">\r\n                <div className=\"row justify-content-center\">\r\n                    <div className=\"col-lg-8\">\r\n                        <div className=\"card shadow-sm\">\r\n                            <div className=\"card-header bg-white\">\r\n                                <h4 className=\"mb-0\">\r\n                                    <CreditCard className=\"me-2\" size={24} />\r\n                                    Checkout\r\n                                </h4>\r\n                            </div>\r\n\r\n                            <div className=\"card-body\">\r\n                                <form onSubmit={handleSubmit}>\r\n                                    {/* Customer Information */}\r\n                                    <div className=\"mb-4\">\r\n                                        <h5 className=\"mb-3\">Customer Information</h5>\r\n                                        <div className=\"row g-3\">\r\n                                            <div className=\"col-md-6\">\r\n                                                <label className=\"form-label\">First Name *</label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    className={`form-control ${errors.firstName ? 'is-invalid' : ''}`}\r\n                                                    name=\"firstName\"\r\n                                                    value={formData.firstName}\r\n                                                    onChange={handleInputChange}\r\n                                                    placeholder=\"Enter your first name\"\r\n                                                />\r\n                                                {errors.firstName && <div className=\"invalid-feedback\">{errors.firstName}</div>}\r\n                                            </div>\r\n                                            <div className=\"col-md-6\">\r\n                                                <label className=\"form-label\">Last Name *</label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    className={`form-control ${errors.lastName ? 'is-invalid' : ''}`}\r\n                                                    name=\"lastName\"\r\n                                                    value={formData.lastName}\r\n                                                    onChange={handleInputChange}\r\n                                                    placeholder=\"Enter your last name\"\r\n                                                />\r\n                                                {errors.lastName && <div className=\"invalid-feedback\">{errors.lastName}</div>}\r\n                                            </div>\r\n                                            <div className=\"col-md-6\">\r\n                                                <label className=\"form-label\">Email *</label>\r\n                                                <input\r\n                                                    type=\"email\"\r\n                                                    className={`form-control ${errors.email ? 'is-invalid' : ''}`}\r\n                                                    name=\"email\"\r\n                                                    value={formData.email}\r\n                                                    onChange={handleInputChange}\r\n                                                    placeholder=\"Enter your email\"\r\n                                                />\r\n                                                {errors.email && <div className=\"invalid-feedback\">{errors.email}</div>}\r\n                                            </div>\r\n                                            <div className=\"col-md-6\">\r\n                                                <label className=\"form-label\">Phone Number *</label>\r\n                                                <input\r\n                                                    type=\"tel\"\r\n                                                    className={`form-control ${errors.phone ? 'is-invalid' : ''}`}\r\n                                                    name=\"phone\"\r\n                                                    value={formData.phone}\r\n                                                    onChange={handleInputChange}\r\n                                                    placeholder=\"Enter 10-digit mobile number\"\r\n                                                />\r\n                                                {errors.phone && <div className=\"invalid-feedback\">{errors.phone}</div>}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Shipping Address */}\r\n                                    <div className=\"mb-4\">\r\n                                        <h5 className=\"mb-3\">\r\n                                            <Truck className=\"me-2\" size={20} />\r\n                                            Shipping Address\r\n                                        </h5>\r\n                                        <div className=\"row g-3\">\r\n                                            <div className=\"col-12\">\r\n                                                <label className=\"form-label\">Address *</label>\r\n                                                <textarea\r\n                                                    className={`form-control ${errors.address ? 'is-invalid' : ''}`}\r\n                                                    name=\"address\"\r\n                                                    value={formData.address}\r\n                                                    onChange={handleInputChange}\r\n                                                    rows=\"3\"\r\n                                                    placeholder=\"Enter your complete address\"\r\n                                                />\r\n                                                {errors.address && <div className=\"invalid-feedback\">{errors.address}</div>}\r\n                                            </div>\r\n                                            <div className=\"col-md-6\">\r\n                                                <label className=\"form-label\">City *</label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    className={`form-control ${errors.city ? 'is-invalid' : ''}`}\r\n                                                    name=\"city\"\r\n                                                    value={formData.city}\r\n                                                    onChange={handleInputChange}\r\n                                                    placeholder=\"Enter your city\"\r\n                                                />\r\n                                                {errors.city && <div className=\"invalid-feedback\">{errors.city}</div>}\r\n                                            </div>\r\n                                            <div className=\"col-md-6\">\r\n                                                <label className=\"form-label\">State *</label>\r\n                                                <select\r\n                                                    className={`form-control ${errors.state ? 'is-invalid' : ''}`}\r\n                                                    name=\"state\"\r\n                                                    value={formData.state}\r\n                                                    onChange={handleInputChange}\r\n                                                >\r\n                                                    <option value=\"\">Select State</option>\r\n                                                    {indianStates.map(state => (\r\n                                                        <option key={state} value={state}>{state}</option>\r\n                                                    ))}\r\n                                                </select>\r\n                                                {errors.state && <div className=\"invalid-feedback\">{errors.state}</div>}\r\n                                            </div>\r\n                                            <div className=\"col-md-6\">\r\n                                                <label className=\"form-label\">PIN Code *</label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    className={`form-control ${errors.pincode ? 'is-invalid' : ''}`}\r\n                                                    name=\"pincode\"\r\n                                                    value={formData.pincode}\r\n                                                    onChange={handleInputChange}\r\n                                                    placeholder=\"Enter 6-digit PIN code\"\r\n                                                />\r\n                                                {errors.pincode && <div className=\"invalid-feedback\">{errors.pincode}</div>}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Payment Method */}\r\n                                    <div className=\"mb-4\">\r\n                                        <h5 className=\"mb-3\">\r\n                                            <Shield className=\"me-2\" size={20} />\r\n                                            Payment Method\r\n                                        </h5>\r\n                                        <div className=\"row g-3\">\r\n                                            <div className=\"col-md-4\">\r\n                                                <div className=\"form-check\">\r\n                                                    <input\r\n                                                        className=\"form-check-input\"\r\n                                                        type=\"radio\"\r\n                                                        name=\"paymentMethod\"\r\n                                                        value=\"card\"\r\n                                                        checked={formData.paymentMethod === 'card'}\r\n                                                        onChange={handleInputChange}\r\n                                                    />\r\n                                                    <label className=\"form-check-label\">\r\n                                                        <CreditCard size={16} className=\"me-2\" />\r\n                                                        Credit/Debit Card\r\n                                                    </label>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div className=\"col-md-4\">\r\n                                                <div className=\"form-check\">\r\n                                                    <input\r\n                                                        className=\"form-check-input\"\r\n                                                        type=\"radio\"\r\n                                                        name=\"paymentMethod\"\r\n                                                        value=\"upi\"\r\n                                                        checked={formData.paymentMethod === 'upi'}\r\n                                                        onChange={handleInputChange}\r\n                                                    />\r\n                                                    <label className=\"form-check-label\">\r\n                                                        UPI\r\n                                                    </label>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div className=\"col-md-4\">\r\n                                                <div className=\"form-check\">\r\n                                                    <input\r\n                                                        className=\"form-check-input\"\r\n                                                        type=\"radio\"\r\n                                                        name=\"paymentMethod\"\r\n                                                        value=\"netbanking\"\r\n                                                        checked={formData.paymentMethod === 'netbanking'}\r\n                                                        onChange={handleInputChange}\r\n                                                    />\r\n                                                    <label className=\"form-check-label\">\r\n                                                        Net Banking\r\n                                                    </label>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Order Summary */}\r\n                                    <div className=\"mb-4\">\r\n                                        <h5 className=\"mb-3\">Order Summary</h5>\r\n                                        <div className=\"border rounded p-3\">\r\n                                            {cartItems.map((item, index) => (\r\n                                                <div key={index} className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                                                    <div className=\"d-flex align-items-center\">\r\n                                                        <img\r\n                                                            src={item.image}\r\n                                                            alt={item.title}\r\n                                                            className=\"rounded me-3\"\r\n                                                            style={{ width: '50px', height: '40px', objectFit: 'cover' }}\r\n                                                        />\r\n                                                        <div>\r\n                                                            <h6 className=\"mb-0\">{item.title}</h6>\r\n                                                            <small className=\"text-muted\">\r\n                                                                {item.instructor} â€¢ {item.duration}\r\n                                                                {item.quantity > 1 && ` â€¢ Qty: ${item.quantity}`}\r\n                                                            </small>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <span className=\"fw-bold\">{formatCurrency(item.price * item.quantity)}</span>\r\n                                                </div>\r\n                                            ))}\r\n                                            <hr />\r\n                                            <div className=\"d-flex justify-content-between\">\r\n                                                <span>Subtotal:</span>\r\n                                                <span>{formatCurrency(subtotal)}</span>\r\n                                            </div>\r\n                                            <div className=\"d-flex justify-content-between\">\r\n                                                <span>Shipping:</span>\r\n                                                <span>{shipping === 0 ? 'Free' : formatCurrency(shipping)}</span>\r\n                                            </div>\r\n                                            <div className=\"d-flex justify-content-between\">\r\n                                                <span>Tax (GST 18%):</span>\r\n                                                <span>{formatCurrency(tax)}</span>\r\n                                            </div>\r\n                                            <hr />\r\n                                            <div className=\"d-flex justify-content-between fw-bold fs-5\">\r\n                                                <span>Total:</span>\r\n                                                <span>{formatCurrency(total)}</span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Security Info */}\r\n                                    <div className=\"alert alert-info d-flex align-items-center mb-4\">\r\n                                        <Shield className=\"me-2\" size={20} />\r\n                                        <small>\r\n                                            Your payment information is secure and encrypted.\r\n                                            We use industry-standard security measures to protect your data.\r\n                                        </small>\r\n                                    </div>\r\n\r\n                                    {/* Submit Button */}\r\n                                    <div className=\"text-center\">\r\n                                        <button\r\n                                            type=\"submit\"\r\n                                            className=\"btn btn-primary btn-lg px-5\"\r\n                                            disabled={loading || cartItems.length === 0}\r\n                                        >\r\n                                            {loading ? (\r\n                                                <>\r\n                                                    <div className=\"spinner-border spinner-border-sm me-2\" role=\"status\">\r\n                                                        <span className=\"visually-hidden\">Loading...</span>\r\n                                                    </div>\r\n                                                    Processing...\r\n                                                </>\r\n                                            ) : (\r\n                                                <>\r\n                                                    <CreditCard className=\"me-2\" size={20} />\r\n                                                    Complete Payment ({formatCurrency(total)})\r\n                                                </>\r\n                                            )}\r\n                                        </button>\r\n                                    </div>\r\n                                </form>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Checkout;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}